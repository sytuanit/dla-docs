# 銀行貸款

## 1. 目的

**銀行貸款**模組可協助您管理銀行貸款，包括：
- 追蹤貸款金額、利率、期限
- 管理付款時間表
- 按期間計算利息（如適用）
- 管理逾期付款罰款
- 提前結清（如需要）

## 2. 使用時機

當您有：
- 銀行貸款時
- 需要追蹤付款時間表時
- 想計算利息和罰款時
- 需要付款到期提醒時

## 3. 相關畫面

- 貸款清單
- 新增貸款（4 個步驟）
- 編輯貸款
- 貸款詳細資訊和付款時間表
- 提前結清

## 4. 主要使用方式

### 4.1 新增貸款（4 個步驟）

#### 步驟 1：基本資訊

1. 前往**功能** → 選擇**銀行貸款**
2. 點擊 **+** (FAB) 按鈕
3. 填寫資訊：
   - **銀行**：選擇或建立新銀行
   - **貸款名稱**：（例如：「房屋貸款」）
   - **貸款金額**：本金金額
   - **撥款日期**：收到錢的日期
   - **期限**：年數
   - **利率類型**：促銷/浮動利率或固定利率
4. 點擊**下一步**

#### 步驟 2：設定利率

**如果選擇「促銷/浮動利率」：**
- 啟用**有促銷利率**（如適用）
- 輸入**促銷月數**和**促銷利率**
- 新增浮動利率期間：
  - 選擇年份和月份範圍
  - 輸入利率（%/年）
  - 選擇**浮動**或**固定**

**如果選擇「固定利率」：**
- 輸入**固定利率**（%/年）

點擊**下一步**

#### 步驟 3：設定罰款

1. 啟用**有逾期付款罰款**（如適用）
2. 新增罰款期間：
   - 選擇年份和月份範圍
   - 輸入**罰款率**（%/年）
3. 點擊**下一步**

#### 步驟 4：確認並儲存

1. 檢閱資訊：
   - 總付款金額
   - 預期付款時間表
2. 點擊**儲存**

### 4.2 查看貸款詳細資訊

1. 前往貸款清單
2. 點擊貸款
3. 查看資訊：
   - 基本資訊
   - 付款時間表
   - 已付金額 / 剩餘
   - 利率和罰款

### 4.3 將付款期間標記為已付

1. 前往貸款詳細資訊
2. 找到到期的付款期間（標籤「未付」）
3. 點擊**標記為已付**
4. 填寫資訊：
   - **實際付款日期**：付款日期（預設 = 今天）
   - **實際支付的利息**：實際支付的利息（預設 = 計劃利息）
   - **備註**：（選填）
5. 查看自動計算的**總實際付款**（本金 + 實際利息）
6. 點擊**確認**

### 4.4 更新目前利率

1. 前往貸款詳細資訊（僅在目前處於浮動利率期間時顯示）
2. 點擊**更新目前利率**
3. 填寫資訊：
   - **新利率**：新利率（%/年）
   - **生效日期**：開始應用新利率的日期（預設 = 目前期間開始）
   - **備註**：（選填）
4. 點擊**儲存**
5. 從目前期間開始的未付期間將以新利率更新

### 4.5 提前結清

1. 前往貸款詳細資訊
2. 點擊**計算結清金額**
3. **步驟 1 - 輸入提前付款資訊：**
   - 選擇方法：**部分付款**或**完全結清**
   - 選擇提前付款日期（預設 = 今天）
   - 輸入提前付款金額（如部分付款）
   - 查看自動計算的**提前付款罰款**
4. 點擊**下一步**
5. **步驟 2 - 比較選項：**
   - 查看「無提前付款」和「提前付款」之間的比較
   - 查看結果：利息節省、時間減少
6. 點擊**確認提前付款**

### 4.6 編輯貸款

1. 前往貸款詳細資訊
2. 點擊**編輯**（僅編輯名稱、備註、銀行）
3. 編輯可編輯資訊：
   - **貸款名稱**：可編輯
   - **銀行**：可變更
   - **備註**：可編輯
   - **貸款金額、撥款日期、期限、利率**：僅在尚未付款時可編輯
4. 點擊**儲存**

## 5. 範例與介面說明

### LOAN-01：建立新貸款（帶促銷利率的房屋貸款）

**目標**：建立新貸款以追蹤房屋貸款、促銷利率和每月付款時間表。

**步驟**：
1. 前往**功能** → 選擇**銀行貸款**
2. 點擊 **+** (FAB) 按鈕新增貸款
3. **步驟 1 - 基本資訊：**
   - 選擇銀行：美國銀行
   - 輸入名稱：「房屋貸款 - 市中心公寓」
   - 輸入貸款金額：6,000,000 TWD
   - 選擇撥款日期：04/01/2023
   - 輸入期限：10 年（自動計算 = 120 期）
   - 選擇通知時間：10:00 和 19:00
   - 選擇利率類型：「遞減餘額」
   - 點擊**下一步**
4. **步驟 2 - 設定利率：**
   - 啟用「有促銷利率期間」
   - 輸入：前 6 個月 @ 6.0%/年
   - 新增後續期間：
     - 第 1 年（第 7-12 個月）：9.0%/年，浮動
     - 第 2 年（第 13-24 個月）：9.5%/年，浮動
     - 第 3 年起：10.0%/年，浮動
   - 點擊**下一步**
5. **步驟 3 - 設定提前付款罰款：**
   - 啟用「應用提前付款罰款」
   - 輸入罰款：第 1-3 年：2.0%，第 4-5 年：1.5%，第 6 年起：1.0%
   - 點擊**下一步**
6. **步驟 4 - 確認：**
   - 檢閱摘要資訊
   - 點擊**建立貸款**

**結果**：貸款建立成功，自動建立 120 期付款時間表，已排程通知。

**線框圖 - 步驟 1：基本資訊**

```text
┌─────────────────────────────────────────┐
│ <  新增貸款                              │
├─────────────────────────────────────────┤
│ 貸款名稱 *                               │
│ [房屋貸款 - 市中心公寓]                  │
│                                          │
│ 銀行 *                                    │
│ [美國銀行 ▼] [+ 建立新銀行]              │
│                                          │
│ 貸款金額 *                                │
│ [6,000,000 TWD]                          │
│                                          │
│ 撥款日期 *                                │
│ [04/01/2023] [📅]                        │
│                                          │
│ 貸款期限（年）*                          │
│ [10] 年                                  │
│ 提示：應用程式自動計算 = 120 期          │
│                                          │
│ 通知時間 1 *                              │
│ [10:00] [🕐]                             │
│                                          │
│ 通知時間 2 *                              │
│ [19:00] [🕐]                             │
│                                          │
│ 利率類型 *                                │
│ ● 遞減餘額                                │
│ ○ 整個期限固定利率                        │
│                                          │
│ [下一步] [取消]                           │
└─────────────────────────────────────────┘
```

---

### LOAN-02：查看貸款清單和詳細資訊

**目標**：查看貸款概覽，依狀態篩選，搜尋，並查看每個貸款的詳細資訊。

**步驟**：
1. 前往**功能** → 選擇**銀行貸款**
2. 查看帶有篩選「啟用中」（預設）和「已完成」的清單畫面
3. 在篩選之間切換以查看不同的概覽
4. 使用搜尋列：輸入「市中心」
5. 點擊貸款查看詳細資訊
6. 查看帶有已付期間、目前期間和未來期間的付款時間表
7. 在付款時間表中使用搜尋列：輸入「9/2024」

**結果**：清單依篩選正確顯示，貸款詳細資訊顯示完整資訊和付款時間表。

**線框圖 - 貸款清單**

```text
┌─────────────────────────────────────────┐
│ <  銀行貸款管理                          │
├─────────────────────────────────────────┤
│ [啟用中] [已完成]                        │
│                                          │
│ ┌─────────────────────────────────────┐  │
│ │ 目前餘額：4,935,000 TWD            │  │
│ │ 原始貸款總額：6,000,000 TWD        │  │
│ │ 已付利息：51,600 TWD               │  │
│ │ 啟用中：1 筆貸款                   │  │
│ └─────────────────────────────────────┘  │
│                                          │
│ [🔍 搜尋（貸款名稱、銀行）]              │
│                                          │
│ ┌─────────────────────────────────────┐  │
│ │ [圖示] 美國銀行  [啟用中]            │  │
│ │ 房屋貸款 - 市中心公寓               │  │
│ │ 餘額：4,935,000 TWD                 │  │
│ │ 原始：6,000,000 TWD                │  │
│ │ 進度：8 / 120 期                    │  │
│ │ 結束日期：04/01/2033               │  │
│ └─────────────────────────────────────┘  │
│                                          │
│                                    [+]   │
└─────────────────────────────────────────┘
```

**線框圖 - 貸款詳細資訊**

```text
┌─────────────────────────────────────────┐
│ <  貸款詳細資訊                          │
├─────────────────────────────────────────┤
│ [圖示] 美國銀行                  [編輯]  │
│ 房屋貸款 - 市中心公寓                   │
│ [啟用中]                                 │
│                                          │
│ 原始貸款：6,000,000 TWD                  │
│ 目前餘額：4,935,000 TWD                  │
│ 已付期間：8 / 120                        │
│ 已付利息：51,600 TWD                     │
│ 目前利率：9.0%/年                        │
│                                          │
│ [更新利率] [計算結清金額]                │
│                                          │
│ 付款時間表                               │
│ [🔍 搜尋期間（例如：「5/2025」）]        │
│                                          │
│ 期間 1 – 05/2023 [已付]                  │
│ 總計：64.5k TWD • 本金：30k TWD • 利息：34.5k TWD│
│                                          │
│ 期間 9 – 01/2024 [未付]                  │
│ 本金：30,000 TWD                         │
│ 利息：34,500 TWD                         │
│ 總計：64,500 TWD                         │
│ 到期日期：01/15/2024                     │
│ [標記為已付]                             │
│                                          │
│ 期間 10 – 02/2024 [未到期]               │
│ 總計：64.5k TWD • 本金：30k TWD • 利息：34.5k TWD│
└─────────────────────────────────────────┘
```

---

### LOAN-03：將付款期間標記為已付（記錄付款）

**目標**：向銀行付款後將付款期間標記為「已付」。

**步驟**：
1. 前往貸款詳細資訊
2. 找到目前期間（期間 9），標籤「未付」
3. 點擊**標記為已付**
4. 填寫資訊：
   - 實際付款日期：01/15/2024（預設 = 今天）
   - 實際支付的利息：34,500 TWD（預設 = 計劃利息）
   - 備註：（選填）
5. 查看自動計算的總實際付款
6. 點擊**確認**

**結果**：期間 9 更新為「已付」，餘額減少，已付期間增加，目前餘額減少。

**線框圖 - 標記為已付對話框**

```text
┌─────────────────────────────────────────┐
│ 標記為已付                               │
├─────────────────────────────────────────┤
│ 期間 9 – 01/2024          [未付]          │
│                                          │
│ 到期日期（計劃）：01/15/2024            │
│ 本金（固定）：30,000 TWD                 │
│                                          │
│ 實際付款日期 *                            │
│ [01/15/2024] [📅]                        │
│                                          │
│ 實際支付的利息 *                          │
│ [34,500 TWD]                             │
│ 提示：計劃利息：34,500 TWD               │
│                                          │
│ 總實際付款 =                             │
│   30,000 TWD（本金）                     │
│ + 34,500 TWD（實際利息）                 │
│ ────────────────────────────────        │
│ = 64,500 TWD                             │
│                                          │
│ 備註（選填）                              │
│ [少付 1,500 TWD，獲得利息減免...]        │
│                                          │
│ [取消] [確認]                            │
└─────────────────────────────────────────┘
```

---

### LOAN-04：更新目前利率（當銀行調整浮動利率時）

**目標**：當銀行宣布浮動利率調整時更新新利率。

**步驟**：
1. 前往貸款詳細資訊
2. 查看「目前利率：9.0%/年」
3. 點擊**更新目前利率**（僅在目前處於浮動利率期間時顯示）
4. 填寫資訊：
   - 新利率：10.5%/年
   - 生效日期：01/15/2024（預設 = 目前期間開始）
   - 備註：「銀行根據新決定調整利率」
5. 點擊**儲存**

**結果**：目前利率已更新，從目前期間開始的未付期間將以新利率更新。

**線框圖 - 更新利率對話框**

```text
┌─────────────────────────────────────────┐
│ 更新目前利率                             │
├─────────────────────────────────────────┤
│ [圖示] 美國銀行                          │
│ 貸款名稱：房屋貸款 - 市中心公寓         │
│ 目前期間：期間 9 – 01/2024               │
│ 狀態：[啟用中]                           │
│ 期間：浮動（促銷後）                     │
│                                          │
│ 目前利率（應用中）：                    │
│ [9.0] %/年（唯讀）                       │
│                                          │
│ 新利率（%/年）*                          │
│ [10.5] %/年                              │
│                                          │
│ 生效日期 *                               │
│ [01/15/2024] [📅]                        │
│                                          │
│ 備註（選填）                              │
│ [銀行調整利率...]                        │
│                                          │
│ • 新利率將應用於從目前期間開始的期間。   │
│ • 先前已付期間不變。                     │
│                                          │
│ [取消] [儲存]                            │
└─────────────────────────────────────────┘
```

---

### LOAN-05：提前結清（部分付款以減少利息）

**目標**：提前結清部分貸款以減少總應付利息並縮短貸款期限。

**步驟**：
1. 前往貸款詳細資訊
2. 點擊**計算結清金額**
3. **步驟 1 - 輸入提前付款資訊：**
   - 選擇方法：「部分付款」
   - 選擇提前付款日期：01/15/2024
   - 輸入提前付款金額：2,400,000 TWD
   - 查看自動計算的罰款：48,000 TWD（2.0%）
   - 點擊**下一步**
4. **步驟 2 - 比較選項：**
   - 查看「無提前付款」和「提前付款 2,400,000 TWD」之間的比較
   - 查看結果：節省 900,000 TWD 利息，減少 40 期
   - 點擊**確認提前付款**

**結果**：餘額減少，付款時間表重新計算，期間數減少，結束日期提前。

**線框圖 - 步驟 1：輸入提前付款資訊**

```text
┌─────────────────────────────────────────┐
│ <  提前結清                              │
├─────────────────────────────────────────┤
│ [圖示] 美國銀行                          │
│ 貸款名稱：房屋貸款 - 市中心公寓         │
│ 目前餘額：6,000,000 TWD                  │
│ 目前期間：期間 9 – 01/2024               │
│                                          │
│ 您想如何結清？                           │
│ ● 部分付款                               │
│ ○ 完全結清                               │
│                                          │
│ 提前付款日期 *                           │
│ [01/15/2024] [📅]                        │
│                                          │
│ 提前付款金額 *                           │
│ [2,400,000 TWD]                          │
│                                          │
│ 應用的罰款率：2.0%                       │
│ 罰款：48,000 TWD                         │
│                                          │
│ [下一步]                                 │
└─────────────────────────────────────────┘
```

**線框圖 - 步驟 2：比較選項**

```text
┌─────────────────────────────────────────┐
│ <  比較選項                               │
├─────────────────────────────────────────┤
│ 選項 A：無提前付款                        │
│ ────────────────────────────────────────│
│ 截至日期的總已付利息：                    │
│   1,560,000 TWD                         │
│ 剩餘總利息：1,560,000 TWD               │
│ 剩餘期間：112 期                         │
│ 結束日期：04/01/2033                    │
│                                          │
│ 選項 B：提前付款 2,400,000 TWD          │
│ ────────────────────────────────────────│
│ 提前付款罰款：48,000 TWD                │
│ 截至日期的總已付利息：                    │
│   1,608,000 TWD                         │
│ 剩餘總利息：594,000 TWD                 │
│ 剩餘期間：72 期                          │
│ 結束日期：04/01/2029                    │
│                                          │
│ 比較結果：                               │
│ • 利息節省：900,000 TWD                  │
│ • 時間減少：40 期（約 3.5 年）           │
│                                          │
│ [確認提前付款]                           │
└─────────────────────────────────────────┘
```

---

### LOAN-06：編輯貸款（編輯基本資訊）

**目標**：開始付款後編輯貸款的基本資訊（名稱、銀行、備註）。

**步驟**：
1. 前往貸款詳細資訊
2. 點擊**編輯**（僅編輯名稱、備註、銀行）
3. 編輯：
   - 貸款名稱：「房屋貸款 - 市中心公寓 - 單位 A1-1201」
   - （選填）變更銀行：大通銀行
   - 備註：「轉移到新銀行」
4. 查看已停用欄位：貸款金額、撥款日期、期限、利率
5. 點擊**儲存**

**結果**：基本資訊已更新，其他資訊不變。

**注意**：如果貸款尚未付款，可以編輯所有資訊（金額、期限、利率設定）。

## 6. 邏輯與規則

### 6.1 促銷/浮動利率

- 可以有促銷期間（較低利率）
- 促銷期間後，利率按期間浮動
- 每個期間可以是**浮動**（基於市場）或**固定**

### 6.2 逾期付款罰款

- 罰款按 %/年計算
- 可以為每個期間設定不同的罰款
- 罰款僅在付款逾期時適用

### 6.3 付款時間表

- 應用程式根據以下項目自動建立付款時間表：
  - 貸款金額
  - 利率
  - 期限
- 每個付款期間包括：本金 + 利息

### 6.4 提前結清

- 計算剩餘金額（本金 + 利息 + 罰款（如有））
- 結清後，貸款將變更為「已完成」狀態

### 6.5 通知

- 付款到期時，應用程式發送提醒通知
- 每個貸款的通知時間可設定（`notificationTime1`、`notificationTime2`，預設 10:00 和 19:00）

## 7. 重要注意事項

- **複雜利率**：此模組支援按期間變更的利率，需要仔細設定
- **存在付款時間表時無法刪除**：如果付款時間表存在，只能結清，無法刪除
- **提前結清**：可能需要額外的罰款費用，取決於銀行政策
- **付款時間表**：付款時間表是自動計算的，您無法直接編輯

