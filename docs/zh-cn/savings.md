# 储蓄

## 1. 目的

**储蓄**模块可帮助您管理银行储蓄账户、追踪余额、利率和期限。此模块支持：
- 管理多个储蓄账户
- 追踪利率和期限
- 到期时自动计算利息
- 提前提款（如需要）
- 账户展期

## 2. 使用时机

当您有：
- 银行储蓄账户时
- 需要追踪余额和利率时
- 希望到期时收到提醒时
- 需要管理多个储蓄账户时

## 3. 相关画面

- 储蓄账户清单
- 新增账户
- 编辑账户
- 账户详细信息
- 提前提款

## 4. 主要使用方式

### 4.1 创建新储蓄账户

1. 前往**功能** → 选择**银行储蓄**
2. 点击右下角的 **+** (FAB) 按钮
3. 查看"当前余额"（可点击查看详细信息）
4. 选择银行：
   - 如果存在：从下拉菜单中选择
   - 如果不存在：点击"+"按钮创建新银行
5. 输入存款金额（必须 ≤ 当前余额）
6. 输入期限：1-36 个月
7. 输入利率：%/年（1-100%）
8. 选择开始日期（默认为今天，可选择从上个月到现在）
9. 查看自动计算的到期日（从开始日期 + 期限）
10. 选择到期计划：
    - 提领本金和利息（默认）
    - 展期本金（利息到账户）
    - 展期本金 + 利息
11. （可选）输入备注
12. （可选）选择通知时间（默认：10:00 和 19:00）
13. 点击**创建账户**

### 4.2 查看清单和账户详细信息

1. 前往**功能** → 选择**银行储蓄**
2. 查看"储蓄账户清单"画面，默认筛选为"启用中"
3. 查看概览卡片：
   - 筛选"启用中"：当前余额、储蓄中的金额、预期利息、本月利息
   - 筛选"已完成"：总提领金额、收到的利息
4. （可选）使用搜索栏依银行名称或代码查找账户
5. 在"启用中"和"已完成"之间切换筛选
6. 点击储蓄账户查看详细信息：
   - 账户信息：银行、期限、利率、存款金额、估计利息
   - 开始日期和到期日
   - 状态：启用中
   - 到期计划
   - （如存在）展期历史
   - "提领"按钮（如启用中）

### 4.3 提领储蓄账户

1. 前往储蓄清单，找到已达到或超过到期日的账户
2. 点击卡片上的**提领**按钮（或前往详细信息然后点击"提领"）
3. 查看"提领储蓄账户"对话框：
   - 账户信息：银行、存款金额、期限、利率
   - 提领日期（默认 = 到期日，可选择不同日期）
   - 收到的利息（默认 = 估计利息，可编辑）
   - 总收到金额（自动计算 = 本金 + 利息）
4. （可选）编辑提领日期或收到的利息
5. 点击**确认**

### 4.4 展期储蓄账户

1. 前往储蓄清单，找到已达到到期日且计划为"展期本金"或"展期本金 + 利息"的账户
2. 点击**展期**按钮或"按计划展期"
3. 查看"展期储蓄账户"对话框：
   - 账户信息：银行、本金金额、期限、利率
   - 收到的利息（如果展期本金，利息到账户）
4. （可选）编辑新利率或新期限（默认 = 旧期限）
5. 点击**确认展期**

### 4.5 编辑储蓄账户

1. 前往启用中储蓄账户详细信息
2. 点击右上角的**编辑**按钮
3. 编辑信息：
   - 银行（如需要）
   - 存款金额（如增加，必须 ≤ 当前余额）
   - 期限、利率
   - 开始日期（如需要）
   - 到期计划
   - 备注、通知时间
4. 查看自动重新计算的到期日（如期限/开始日期变更）
5. 点击**保存更改**

### 4.6 创建新银行

1. 在"新增储蓄账户"或"编辑储蓄账户"画面上
2. 点击"银行"字段
3. 点击下拉菜单旁的"+"按钮创建新银行
4. 查看"新增新银行"对话框
5. 输入银行名称
6. 输入银行代码（最多 3-4 个字符，自动大写）
7. 选择图标颜色（从颜色选择器或调色板）
8. 查看图标预览
9. 点击**创建**

## 5. 示例与用户界面图示

### SAVINGS-01：创建新储蓄账户

**目标**：创建新储蓄账户以追踪银行存款、利率和到期日。

**主要步骤**：
1. 前往功能 → 银行储蓄
2. 点击"+"(FAB) 按钮
3. 选择银行（或创建新银行）
4. 输入存款金额、期限、利率
5. 选择开始日期（默认今天）
6. 选择到期计划
7. （可选）输入备注和通知时间
8. 点击"创建账户"

**线框图 - 新增储蓄账户画面**：

```text
┌──────────────────────────────────────────────┐
│ <  新增储蓄账户                               │
└──────────────────────────────────────────────┘

┌──────────────────────────────────────────────┐
│ [ 卡片 ]                                      │
│                                               │
│ 当前余额                              [ > ]    │
│ 14,560 CNY                                    │
│                                               │
│ 银行 *                                        │
│ [ 美国银行 ▼ ]                         [ + ] │
│                                               │
│ 存款金额 (CNY) *                             │
│ [ 28,000 CNY ]                               │
│                                               │
│ 期限 *                                        │
│ [ 6 ] 个月                                    │
│                                               │
│ 利率 *                                        │
│ [ 4.8 ] %/年                                  │
│                                               │
│ 开始日期 *                                    │
│ [ 12/20/2025 ]                    [📅]        │
│                                               │
│ 到期日（只读）                                │
│ [ 06/20/2026 ]                                │
│                                               │
│ 到期计划                                      │
│ (●) 提领本金和利息                            │
│ ( ) 展期本金                                  │
│ ( ) 展期本金 + 利息                           │
│                                               │
│ 备注（可选）                                  │
│ [                                      ]      │
│                                               │
│ 通知时间 1                                    │
│ [ 10:00 ]                          [🕐]       │
│                                               │
│ 通知时间 2                                    │
│ [ 19:00 ]                          [🕐]       │
└──────────────────────────────────────────────┘

        [  取消  ]       [  创建账户  ]
```

---

### SAVINGS-02：提领储蓄账户

**目标**：当储蓄账户达到到期日时提领以收到本金和利息。

**主要步骤**：
1. 前往储蓄清单，找到已达到或超过到期日的账户
2. 点击"提领"按钮
3. 查看带有账户信息、提领日期、收到利息的对话框
4. （可选）编辑提领日期或收到的利息
5. 点击"确认"

**线框图 - 提领对话框**：

```text
┌─────────────────────────────────────────┐
│  提领储蓄账户                            │
├─────────────────────────────────────────┤
│  [图标银行]  美国银行                    │
│                                         │
│  期限和利率：6 个月 · 4.8%/年           │
│  存款金额：28,000 CNY                   │
│                                         │
│  提领日期：                              │
│  [ 12 / 20 / 2025 ]  [📅]               │
│                                         │
│  收到的利息：                            │
│  [ 672 CNY ]                            │
│                                         │
│  总收到金额：28,672 CNY                 │
│                                         │
│  [  确认  ]                              │
└─────────────────────────────────────────┘
```

---

### SAVINGS-03：查看清单和账户详细信息

**目标**：查看启用中和已完成的储蓄账户概览，以及每个账户的详细信息。

**主要步骤**：
1. 前往功能 → 银行储蓄
2. 依筛选查看概览卡片
3. 使用搜索栏（可选）
4. 在"启用中"和"已完成"之间切换筛选
5. 点击账户查看详细信息

**线框图 - 清单画面**：

```text
┌──────────────────────────────────────────────┐
│ <  银行储蓄管理                                │
│                  [ + [FAB] 新增账户 ]         │
└──────────────────────────────────────────────┘

[芯片] 筛选
[ 启用中 ]   [ 已完成 ]

┌──────────────────────────────────────────────┐
│  概览卡片                                    │
│  ┌──────────────┐  ┌──────────────┐         │
│  │ 当前         │  │ 预期         │         │
│  │ 余额         │  │ 利息         │         │
│  │ 14,560 CNY   │  │ 1,533 CNY    │         │
│  └──────────────┘  └──────────────┘         │
│  ┌──────────────┐  ┌──────────────┐         │
│  │ 储蓄中的     │  │ 本月的       │         │
│  │ 金额         │  │ 利息         │         │
│  │ 98,000 CNY   │  │ 532 CNY      │         │
│  └──────────────┘  └──────────────┘         │
└──────────────────────────────────────────────┘

┌──────────────────────────────────────────────┐
│  🔍 搜索栏                                    │
│  [ 🔍 搜索... ]                              │
└──────────────────────────────────────────────┘

┌──────────────────────────────────────────────┐
│ [图标银行] 美国银行      [图标删除]           │
│                                              │
│ 28,000 CNY      |  6 个月 @ 4.8%           │
│                                              │
│ 估计利息：672 CNY                            │
│ 到期：12/20/2025   （剩余 5 天）            │
│                    🔔 即将到期               │
│                                              │
│                    [ 提领 ]                 │
└──────────────────────────────────────────────┘
```

**线框图 - 详细信息画面**：

```text
┌──────────────────────────────────────────────┐
│ [图标银行]  美国银行                  [ 编辑 ]│
│                                              │
│ 期限和利率：6 个月 · 4.8%/年                │
│ 存款金额：28,000 CNY                         │
│ 估计利息：672 CNY                            │
│                                              │
│ 开始日期：06/20/2025                          │
│ 到期日：（剩余 5 天）12/20/2025              │
│                                              │
│ 状态：启用中                                 │
│                                              │
│ 到期计划：                                   │
│ (●) 提领本金和利息                          │
│                                              │
│                    [  提领  ]               │
└──────────────────────────────────────────────┘
```

---

### SAVINGS-04：展期储蓄账户

**目标**：当储蓄账户达到到期日时按计划展期。

**主要步骤**：
1. 找到已达到到期日且计划为"展期本金"或"展期本金 + 利息"的账户
2. 点击"展期"按钮
3. 查看带有账户信息和收到利息的对话框
4. （可选）编辑新利率或新期限
5. 点击"确认展期"

**结果**：旧账户已更新，新账户已创建，rootSavingId 链接到旧账户。如果展期本金，利息会加到当前余额。如果展期本金 + 利息，本金和利息都会展期。

---

### SAVINGS-05：创建新银行

**目标**：创建新银行以在创建储蓄账户时使用。

**主要步骤**：
1. 在"新增储蓄账户"或"编辑储蓄账户"画面上
2. 点击"银行"下拉菜单旁的"+"按钮
3. 输入银行名称、银行代码
4. 选择图标颜色
5. 查看图标预览
6. 点击"创建"

**线框图 - 创建银行对话框**：

```text
┌─────────────────────────────────────────┐
│  新增新银行                              │
├─────────────────────────────────────────┤
│  银行名称                                │
│  [ ABC 银行 ]                            │
│                                         │
│  银行代码                                │
│  [ ABC ]                                 │
│                                         │
│  图标颜色                                │
│  [ 🎨 ]  #FF5722                         │
│                                         │
│  预览图标                                │
│  ┌─────────┐                             │
│  │   ABC   │  （背景：#FF5722）          │
│  └─────────┘                             │
│                                         │
│  [  取消  ]    [  创建  ]               │
└─────────────────────────────────────────┘
```

---

### SAVINGS-06：编辑储蓄账户

**目标**：编辑启用中储蓄账户的信息（银行、金额、期限、利率、到期计划）。

**主要步骤**：
1. 前往启用中储蓄账户详细信息
2. 点击"编辑"按钮
3. 编辑必要信息
4. 查看自动重新计算的到期日（如期限/开始日期变更）
5. 点击"保存更改"

**结果**：账户信息已更新，估计利息根据新利率重新计算。如果金额变更，当前余额会相应调整。

## 6. 逻辑与规则

### 6.1 利息计算

- 利息按公式计算：`金额 × 利率 × (期限 / 12)`
- 利息在到期时或提前提款时计算

### 6.2 状态

- **启用中 (ACTIVE)**：储蓄账户启用中，尚未达到到期日或尚未处理
- **已完成 (COMPLETED)**：账户已提领
- **已展期 (ROLLED_OVER)**：账户已展期，新账户已创建

### 6.3 提领和展期

- **提领**：提领时，本金 + 利息会加到当前余额，自动创建类别为"储蓄利息"的"额外收入"
- **提前提领**：可在到期日前提领，收到的利息可能低于估计利息
- **展期本金**：利息加到当前余额，本金以新期限展期
- **展期本金 + 利息**：本金和利息都展期，当前余额不变
- **展期历史**：展期会保存并显示在账户详细信息中，通过 `rootSavingId` 链接

### 6.4 通知

- 到期日到达时，应用程序发送提醒通知
- 每个账户的通知时间可配置（`notificationTime1`、`notificationTime2`，默认 10:00 和 19:00）

## 7. 重要注意事项

- **需要高级模块**：此功能仅供高级用户使用
- **利率**：输入每年利率（%/年），从 1 到 100%
- **期限**：以月计算，从 1 到 36 个月
- **到期日**：从开始日期 + 期限自动计算
- **存款金额**：必须 ≤ 当前余额，创建账户时会自动从当前余额扣除
- **开始日期**：只能选择从上个月初到现在
- **通知**：通知在到期日的 2 个时间发送（默认 10:00 和 19:00），可为每个账户自定义
- **标签"即将到期"**：当距离到期日 ≤ 7 天时显示
- **标签"已到期"**：当到期日已到达时显示
- **删除账户**：删除启用中账户时，本金金额会加回当前余额。删除根账户将删除整个展期链
- **概览卡片**：依筛选变更，显示启用中或已完成账户的汇总信息

