# สำรองข้อมูลและกู้คืน

## 1. วัตถุประสงค์

โมดูล **สำรองข้อมูลและกู้คืน** ช่วยให้คุณ:
- สำรองข้อมูลแอปทั้งหมดไปยังไฟล์
- กู้คืนข้อมูลจากไฟล์สำรองข้อมูล
- ป้องกันข้อมูลจากการสูญหายเนื่องจากข้อผิดพลาดของอุปกรณ์หรือการติดตั้งแอปใหม่

## 2. เมื่อใดควรใช้

ใช้โมดูลนี้เมื่อคุณต้องการ:
- สำรองข้อมูลก่อนติดตั้งแอปใหม่
- โอนย้ายข้อมูลไปยังอุปกรณ์ใหม่
- กู้คืนข้อมูลหลังจากสูญหายข้อมูล
- สร้างสำรองข้อมูลเป็นระยะ

## 3. หน้าจอที่เกี่ยวข้อง

- หน้าจอสำรองข้อมูล
- หน้าจอกู้คืนข้อมูล

## 4. การใช้งานหลัก

### 4.1 สำรองข้อมูล

1. ไปที่ **การตั้งค่า** → **สำรองข้อมูลและข้อมูล** → **สำรองข้อมูล**
2. ดูข้อมูล:
   - จำนวนระเบียนที่จะสำรอง
   - ขนาดไฟล์ที่คาดหวัง
3. แตะ **สำรองข้อมูล**
4. เลือกตำแหน่งบันทึก (ระบบไฟล์)
5. ไฟล์สำรองข้อมูลจะถูกสร้างด้วยชื่อ: `dla-backup-YYYY-MM-DD-HHmmss.json`
6. บันทึกไฟล์นี้ในที่ปลอดภัย (คลาวด์, คอมพิวเตอร์, ฯลฯ)

### 4.2 กู้คืนข้อมูล

1. ไปที่ **การตั้งค่า** → **สำรองข้อมูลและข้อมูล** → **กู้คืนข้อมูล**
2. เลือกไฟล์สำรองข้อมูลจากระบบไฟล์
3. ดูข้อมูลไฟล์:
   - วันที่สร้างสำรองข้อมูล
   - จำนวนระเบียน
   - ขนาดไฟล์
4. **คำเตือน**: การกู้คืนจะเขียนทับข้อมูลปัจจุบันทั้งหมด
5. แตะ **กู้คืนข้อมูล**
6. ยืนยันการกู้คืน
7. รอให้กระบวนการกู้คืนเสร็จสมบูรณ์
8. แอปจะโหลดใหม่อัตโนมัติ

## 5. ภาพประกอบ UI (Wireframe)

### 5.1 หน้าจอสำรองข้อมูล

```text
┌─────────────────────────────────────────┐
│  ← กลับ    สำรองข้อมูล                   │
├─────────────────────────────────────────┤
│  ข้อมูลการสำรองข้อมูล                    │
│                                         │
│  ┌───────────────────────────────────┐ │
│  │ จำนวนระเบียน                        │ │
│  │ 1,234 ระเบียน                       │ │
│  │                                    │ │
│  │ ขนาดที่คาดหวัง                      │ │
│  │ ~2.5 MB                            │ │
│  │                                    │ │
│  │ ข้อมูลที่จะสำรอง:                   │ │
│  │ • รายได้ประจำ                       │ │
│  │ • ค่าใช้จ่ายประจำ                   │ │
│  │ • ค่าใช้จ่ายรายวัน                  │ │
│  │ • งบประมาณ                          │ │
│  │ • เงินออม                           │ │
│  │ • เงินกู้                           │ │
│  │ • โอกาสพิเศษ                        │ │
│  │ • หมวดหมู่                          │ │
│  └───────────────────────────────────┘ │
│                                         │
│  [สำรองข้อมูล]                         │
└─────────────────────────────────────────┘
```

### 5.2 หน้าจอกู้คืนข้อมูล

```text
┌─────────────────────────────────────────┐
│  ← กลับ    กู้คืนข้อมูล                  │
├─────────────────────────────────────────┤
│  เลือกไฟล์สำรองข้อมูล                   │
│                                         │
│  [เลือกไฟล์...]                        │
│                                         │
│  ข้อมูลไฟล์                             │
│  ┌───────────────────────────────────┐ │
│  │ ไฟล์: dla-backup-2024-11-15.json  │ │
│  │                                    │ │
│  │ สร้างเมื่อ: 15/11/2024 10:30       │ │
│  │                                    │ │
│  │ จำนวนระเบียน: 1,234                │ │
│  │                                    │ │
│  │ ขนาด: 2.5 MB                       │ │
│  └───────────────────────────────────┘ │
│                                         │
│  ⚠️ คำเตือน                             │
│  การกู้คืนจะเขียนทับข้อมูลปัจจุบันทั้งหมด│
│  คุณแน่ใจหรือไม่?                       │
│                                         │
│  [กู้คืนข้อมูล] [ยกเลิก]               │
└─────────────────────────────────────────┘
```

## 6. ตรรกะและกฎ

### 6.1 รูปแบบไฟล์สำรองข้อมูล

- ไฟล์สำรองข้อมูลเป็นรูปแบบ JSON
- ชื่อไฟล์: `dla-backup-YYYY-MM-DD-HHmmss.json`
- ประกอบด้วยข้อมูลทั้งหมด: ผู้ใช้, หมวดหมู่, ธุรกรรม, งบประมาณ, ฯลฯ

### 6.2 ข้อมูลที่สำรอง

- ตารางทั้งหมดในฐานข้อมูล
- รวมทั้งข้อมูลระบบและข้อมูลผู้ใช้
- ไม่รวม: การตั้งค่าแอป, ค่าตั้งค่า (ภาษา, สกุลเงิน)

### 6.3 การกู้คืน

- การกู้คืนจะลบข้อมูลปัจจุบันทั้งหมด
- จากนั้นนำเข้าข้อมูลจากไฟล์สำรองข้อมูล
- แอปจะโหลดใหม่อัตโนมัติหลังจากกู้คืนเสร็จสมบูรณ์

### 6.4 การตรวจสอบ

- แอปตรวจสอบรูปแบบไฟล์ก่อนกู้คืน
- ตรวจสอบความเข้ากันได้ของเวอร์ชัน (ถ้ามี)
- แสดงข้อผิดพลาดถ้าไฟล์ไม่ถูกต้อง

## 7. หมายเหตุสำคัญ

- **สำรองข้อมูลเป็นประจำ**: ควรสำรองเป็นระยะ (รายสัปดาห์หรือรายเดือน)
- **บันทึกในหลายที่**: บันทึกไฟล์สำรองข้อมูลในหลายที่ (คลาวด์, คอมพิวเตอร์, USB)
- **การกู้คืนจะสูญเสียข้อมูลปัจจุบัน**: ตรวจสอบให้แน่ใจว่าคุณได้สำรองข้อมูลปัจจุบันก่อนกู้คืน
- **ไม่สามารถยกเลิกได้**: หลังจากกู้คืนแล้ว ไม่สามารถยกเลิกได้

