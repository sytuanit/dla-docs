# เงินออม

## 1. วัตถุประสงค์

โมดูล **เงินออม** ช่วยให้คุณจัดการบัญชีเงินออมธนาคาร ติดตามยอดเงิน อัตราดอกเบี้ย และระยะเวลา โมดูลนี้รองรับ:
- จัดการบัญชีเงินออมหลายบัญชี
- ติดตามอัตราดอกเบี้ยและระยะเวลา
- คำนวณดอกเบี้ยอัตโนมัติเมื่อครบกำหนด
- ถอนเงินก่อนกำหนด (ถ้าจำเป็น)
- การต่ออายุบัญชี

## 2. เมื่อใดควรใช้

ใช้โมดูลนี้เมื่อคุณมี:
- บัญชีเงินออมธนาคาร
- ต้องการติดตามยอดเงินและอัตราดอกเบี้ย
- ต้องการการแจ้งเตือนเมื่อครบกำหนด
- ต้องการจัดการบัญชีเงินออมหลายบัญชี

## 3. หน้าจอที่เกี่ยวข้อง

- รายการบัญชีเงินออม
- เพิ่มบัญชีใหม่
- แก้ไขบัญชี
- รายละเอียดบัญชี
- ถอนเงินก่อนกำหนด

## 4. การใช้งานหลัก

### 4.1 สร้างบัญชีเงินออมใหม่

1. ไปที่ **ฟังก์ชัน** → เลือก **เงินออมธนาคาร**
2. แตะปุ่ม **+** (FAB) ที่มุมล่างขวา
3. ดู "ยอดเงินปัจจุบัน" (สามารถคลิกเพื่อดูรายละเอียด)
4. เลือกธนาคาร:
   - ถ้ามี: เลือกจากดรอปดาวน์
   - ถ้าไม่มี: แตะปุ่ม "+" เพื่อสร้างธนาคารใหม่
5. ใส่จำนวนเงินฝาก (ต้อง ≤ ยอดเงินปัจจุบัน)
6. ใส่ระยะเวลา: 1-36 เดือน
7. ใส่อัตราดอกเบี้ย: %/ปี (1-100%)
8. เลือกวันที่เริ่มต้น (ค่าเริ่มต้นคือวันนี้ สามารถเลือกจากเดือนก่อนหน้าถึงปัจจุบัน)
9. ดูวันที่ครบกำหนดคำนวณอัตโนมัติ (จากวันที่เริ่มต้น + ระยะเวลา)
10. เลือกแผนเมื่อครบกำหนด:
    - ถอนเงินต้นและดอกเบี้ย (ค่าเริ่มต้น)
    - ต่ออายุเงินต้น (ดอกเบี้ยเข้าบัญชี)
    - ต่ออายุเงินต้น + ดอกเบี้ย
11. (ไม่บังคับ) ใส่หมายเหตุ
12. (ไม่บังคับ) เลือกเวลาแจ้งเตือน (ค่าเริ่มต้น: 10:00 และ 19:00)
13. แตะ **สร้างบัญชี**

### 4.2 ดูรายการและรายละเอียดบัญชี

1. ไปที่ **ฟังก์ชัน** → เลือก **เงินออมธนาคาร**
2. ดูหน้าจอ "รายการบัญชีเงินออม" พร้อมตัวกรองเริ่มต้น "ใช้งาน"
3. ดูการ์ดภาพรวม:
   - ตัวกรอง "ใช้งาน": ยอดเงินปัจจุบัน, เงินในบัญชีออม, ดอกเบี้ยที่คาดหวัง, ดอกเบี้ยเดือนนี้
   - ตัวกรอง "เสร็จสมบูรณ์": ถอนเงินรวม, ดอกเบี้ยที่ได้รับ
4. (ไม่บังคับ) ใช้แถบค้นหาเพื่อหาบัญชีตามชื่อธนาคารหรือรหัส
5. สลับตัวกรองระหว่าง "ใช้งาน" และ "เสร็จสมบูรณ์"
6. แตะที่บัญชีเงินออมเพื่อดูรายละเอียด:
   - ข้อมูลบัญชี: ธนาคาร, ระยะเวลา, อัตราดอกเบี้ย, จำนวนเงินฝาก, ดอกเบี้ยโดยประมาณ
   - วันที่เริ่มต้นและวันที่ครบกำหนด
   - สถานะ: ใช้งาน
   - แผนเมื่อครบกำหนด
   - (ถ้ามี) ประวัติการต่ออายุ
   - ปุ่ม "ถอนเงิน" (ถ้าทำงาน)

### 4.3 ถอนบัญชีเงินออม

1. ไปที่รายการเงินออม หาบัญชีที่ถึงหรือผ่านวันที่ครบกำหนด
2. แตะปุ่ม **ถอนเงิน** ในการ์ด (หรือไปที่รายละเอียดแล้วแตะ "ถอนเงิน")
3. ดูกล่องโต้ตอบ "ถอนบัญชีเงินออม" พร้อม:
   - ข้อมูลบัญชี: ธนาคาร, จำนวนเงินฝาก, ระยะเวลา, อัตราดอกเบี้ย
   - วันที่ถอน (ค่าเริ่มต้น = วันที่ครบกำหนด สามารถเลือกวันที่อื่นได้)
   - ดอกเบี้ยที่ได้รับ (ค่าเริ่มต้น = ดอกเบี้ยโดยประมาณ สามารถแก้ไขได้)
   - รวมที่ได้รับ (คำนวณอัตโนมัติ = เงินต้น + ดอกเบี้ย)
4. (ไม่บังคับ) แก้ไขวันที่ถอนหรือดอกเบี้ยที่ได้รับ
5. แตะ **ยืนยัน**

### 4.4 ต่ออายุบัญชีเงินออม

1. ไปที่รายการเงินออม หาบัญชีที่ถึงวันที่ครบกำหนดพร้อมแผน "ต่ออายุเงินต้น" หรือ "ต่ออายุเงินต้น + ดอกเบี้ย"
2. แตะปุ่ม **ต่ออายุ** หรือ "ต่ออายุตามแผน"
3. ดูกล่องโต้ตอบ "ต่ออายุบัญชีเงินออม" พร้อม:
   - ข้อมูลบัญชี: ธนาคาร, จำนวนเงินต้น, ระยะเวลา, อัตราดอกเบี้ย
   - ดอกเบี้ยที่ได้รับ (ถ้าต่ออายุเงินต้น ดอกเบี้ยเข้าบัญชี)
4. (ไม่บังคับ) แก้ไขอัตราดอกเบี้ยใหม่หรือระยะเวลาใหม่ (ค่าเริ่มต้น = ระยะเวลาเดิม)
5. แตะ **ยืนยันการต่ออายุ**

### 4.5 แก้ไขบัญชีเงินออม

1. ไปที่รายละเอียดบัญชีเงินออมที่ใช้งาน
2. แตะปุ่ม **แก้ไข** ที่มุมบนขวา
3. แก้ไขข้อมูล:
   - ธนาคาร (ถ้าจำเป็น)
   - จำนวนเงินฝาก (ถ้าเพิ่ม ต้อง ≤ ยอดเงินปัจจุบัน)
   - ระยะเวลา, อัตราดอกเบี้ย
   - วันที่เริ่มต้น (ถ้าจำเป็น)
   - แผนเมื่อครบกำหนด
   - หมายเหตุ, เวลาแจ้งเตือน
4. ดูวันที่ครบกำหนดคำนวณใหม่อัตโนมัติ (ถ้าเปลี่ยนระยะเวลา/วันที่เริ่มต้น)
5. แตะ **บันทึกการเปลี่ยนแปลง**

### 4.6 สร้างธนาคารใหม่

1. บนหน้าจอ "เพิ่มบัญชีเงินออม" หรือ "แก้ไขบัญชีเงินออม"
2. แตะที่ฟิลด์ "ธนาคาร"
3. แตะปุ่ม "+" ข้างดรอปดาวน์เพื่อสร้างธนาคารใหม่
4. ดูกล่องโต้ตอบ "เพิ่มธนาคารใหม่"
5. ใส่ชื่อธนาคาร
6. ใส่รหัสธนาคาร (สูงสุด 3-4 ตัวอักษร ตัวพิมพ์ใหญ่อัตโนมัติ)
7. เลือกสีไอคอน (จากตัวเลือกสีหรือจานสี)
8. ดูตัวอย่างไอคอน
9. แตะ **สร้าง**

## 5. ตัวอย่างและภาพประกอบ UI

### SAVINGS-01: สร้างบัญชีเงินออมใหม่

**เป้าหมาย**: สร้างบัญชีเงินออมใหม่เพื่อติดตามเงินฝากธนาคาร อัตราดอกเบี้ย และวันที่ครบกำหนด

**ขั้นตอนหลัก**:
1. ไปที่ฟังก์ชัน → เงินออมธนาคาร
2. แตะปุ่ม "+" (FAB)
3. เลือกธนาคาร (หรือสร้างใหม่)
4. ใส่จำนวนเงินฝาก, ระยะเวลา, อัตราดอกเบี้ย
5. เลือกวันที่เริ่มต้น (ค่าเริ่มต้นวันนี้)
6. เลือกแผนเมื่อครบกำหนด
7. (ไม่บังคับ) ใส่หมายเหตุและเวลาแจ้งเตือน
8. แตะ "สร้างบัญชี"

**Wireframe - หน้าจอเพิ่มบัญชีเงินออม**:

```text
┌──────────────────────────────────────────────┐
│ <  เพิ่มบัญชีเงินออม                          │
└──────────────────────────────────────────────┘

┌──────────────────────────────────────────────┐
│ [ การ์ด ]                                      │
│                                               │
│ ยอดเงินปัจจุบัน                      [ > ]    │
│ ฿72,800                                       │
│                                               │
│ ธนาคาร *                                      │
│ [ ธนาคารกรุงเทพ ▼ ]                   [ + ] │
│                                               │
│ จำนวนเงินฝาก (THB) *                          │
│ [ ฿140,000 ]                                  │
│                                               │
│ ระยะเวลา *                                     │
│ [ 6 ] เดือน                                   │
│                                               │
│ อัตราดอกเบี้ย *                                │
│ [ 4.8 ] %/ปี                                  │
│                                               │
│ วันที่เริ่มต้น *                               │
│ [ 20/12/2025 ]                    [📅]        │
│                                               │
│ วันที่ครบกำหนด (อ่านอย่างเดียว)                │
│ [ 20/06/2026 ]                                 │
│                                               │
│ แผนเมื่อครบกำหนด                              │
│ (●) ถอนเงินต้นและดอกเบี้ย                    │
│ ( ) ต่ออายุเงินต้น                            │
│ ( ) ต่ออายุเงินต้น + ดอกเบี้ย                 │
│                                               │
│ หมายเหตุ (ไม่บังคับ)                          │
│ [                                      ]      │
│                                               │
│ เวลาแจ้งเตือนครั้งที่ 1                       │
│ [ 10:00 ]                          [🕐]       │
│                                               │
│ เวลาแจ้งเตือนครั้งที่ 2                        │
│ [ 19:00 ]                          [🕐]       │
└──────────────────────────────────────────────┘

        [  ยกเลิก  ]       [  สร้างบัญชี  ]
```

---

### SAVINGS-02: ถอนบัญชีเงินออม

**เป้าหมาย**: ถอนบัญชีเงินออมเมื่อถึงวันที่ครบกำหนดเพื่อรับเงินต้นและดอกเบี้ย

**ขั้นตอนหลัก**:
1. ไปที่รายการเงินออม หาบัญชีที่ถึงหรือผ่านวันที่ครบกำหนด
2. แตะปุ่ม "ถอนเงิน"
3. ดูกล่องโต้ตอบพร้อมข้อมูลบัญชี วันที่ถอน ดอกเบี้ยที่ได้รับ
4. (ไม่บังคับ) แก้ไขวันที่ถอนหรือดอกเบี้ยที่ได้รับ
5. แตะ "ยืนยัน"

**Wireframe - กล่องโต้ตอบถอนเงิน**:

```text
┌─────────────────────────────────────────┐
│  ถอนบัญชีเงินออม                         │
├─────────────────────────────────────────┤
│  [ไอคอนธนาคาร]  ธนาคารกรุงเทพ            │
│                                         │
│  ระยะเวลา & อัตราดอกเบี้ย: 6 เดือน · 4.8%/ปี │
│  จำนวนเงินฝาก: ฿140,000                │
│                                         │
│  วันที่ถอน:                             │
│  [ 20 / 12 / 2025 ]  [📅]               │
│                                         │
│  ดอกเบี้ยที่ได้รับ:                     │
│  [ ฿3,360 ]                             │
│                                         │
│  รวมที่ได้รับ: ฿143,360                 │
│                                         │
│  [  ยืนยัน  ]                           │
└─────────────────────────────────────────┘
```

---

### SAVINGS-03: ดูรายการและรายละเอียดบัญชี

**เป้าหมาย**: ดูภาพรวมของบัญชีเงินออมที่ใช้งานและเสร็จสมบูรณ์ รวมถึงรายละเอียดของแต่ละบัญชี

**ขั้นตอนหลัก**:
1. ไปที่ฟังก์ชัน → เงินออมธนาคาร
2. ดูการ์ดภาพรวมตามตัวกรอง
3. ใช้แถบค้นหา (ไม่บังคับ)
4. สลับตัวกรองระหว่าง "ใช้งาน" และ "เสร็จสมบูรณ์"
5. แตะที่บัญชีเพื่อดูรายละเอียด

**Wireframe - หน้าจอรายการ**:

```text
┌──────────────────────────────────────────────┐
│ <  การจัดการเงินออมธนาคาร                    │
│                  [ + [FAB] เพิ่มบัญชี ]      │
└──────────────────────────────────────────────┘

[ชิป] ตัวกรอง
[ ใช้งาน ]   [ เสร็จสมบูรณ์ ]

┌──────────────────────────────────────────────┐
│  การ์ดภาพรวม                                  │
│  ┌──────────────┐  ┌──────────────┐         │
│  │ ยอดเงิน      │  │ ดอกเบี้ย      │         │
│  │ ปัจจุบัน     │  │ ที่คาดหวัง    │         │
│  │ ฿72,800      │  │ ฿7,665        │         │
│  └──────────────┘  └──────────────┘         │
│  ┌──────────────┐  ┌──────────────┐         │
│  │ เงินใน       │  │ ดอกเบี้ย      │         │
│  │ บัญชีออม     │  │ เดือนนี้      │         │
│  │ ฿490,000     │  │ ฿2,660        │         │
│  └──────────────┘  └──────────────┘         │
└──────────────────────────────────────────────┘

┌──────────────────────────────────────────────┐
│  🔍 แถบค้นหา                                  │
│  [ 🔍 ค้นหา... ]                              │
└──────────────────────────────────────────────┘

┌──────────────────────────────────────────────┐
│ [ไอคอนธนาคาร] ธนาคารกรุงเทพ      [ไอคอนลบ] │
│                                              │
│ ฿140,000         |  6 เดือน @ 4.8%          │
│                                              │
│ ดอกเบี้ยโดยประมาณ: ฿3,360                   │
│ ครบกำหนด: 20/12/2025   (เหลือ 5 วัน)        │
│                    🔔 ใกล้ครบกำหนด           │
│                                              │
│                    [ ถอนเงิน ]              │
└──────────────────────────────────────────────┘
```

**Wireframe - หน้าจอรายละเอียด**:

```text
┌──────────────────────────────────────────────┐
│ [ไอคอนธนาคาร]  ธนาคารกรุงเทพ          [ แก้ไข ]│
│                                              │
│ ระยะเวลา & อัตราดอกเบี้ย: 6 เดือน · 4.8%/ปี  │
│ จำนวนเงินฝาก: ฿140,000                       │
│ ดอกเบี้ยโดยประมาณ: ฿3,360                   │
│                                              │
│ วันที่เริ่มต้น: 20/06/2025                   │
│ วันที่ครบกำหนด: (เหลือ 5 วัน) 20/12/2025    │
│                                              │
│ สถานะ: ใช้งาน                                │
│                                              │
│ แผนเมื่อครบกำหนด:                            │
│ (●) ถอนเงินต้นและดอกเบี้ย                    │
│                                              │
│                    [  ถอนเงิน  ]            │
└──────────────────────────────────────────────┘
```

---

### SAVINGS-04: ต่ออายุบัญชีเงินออม

**เป้าหมาย**: ต่ออายุบัญชีเงินออมตามแผนเมื่อถึงวันที่ครบกำหนด

**ขั้นตอนหลัก**:
1. หาบัญชีที่ถึงวันที่ครบกำหนดพร้อมแผน "ต่ออายุเงินต้น" หรือ "ต่ออายุเงินต้น + ดอกเบี้ย"
2. แตะปุ่ม "ต่ออายุ"
3. ดูกล่องโต้ตอบพร้อมข้อมูลบัญชีและดอกเบี้ยที่ได้รับ
4. (ไม่บังคับ) แก้ไขอัตราดอกเบี้ยใหม่หรือระยะเวลาใหม่
5. แตะ "ยืนยันการต่ออายุ"

**ผลลัพธ์**: บัญชีเดิมถูกอัปเดต บัญชีใหม่ถูกสร้างพร้อม rootSavingId ที่เชื่อมโยงกับบัญชีเดิม ถ้าต่ออายุเงินต้น ดอกเบี้ยจะถูกเพิ่มเข้ายอดเงินปัจจุบัน ถ้าต่ออายุเงินต้น + ดอกเบี้ย ทั้งเงินต้นและดอกเบี้ยจะถูกต่ออายุ ยอดเงินปัจจุบันไม่เปลี่ยนแปลง

---

### SAVINGS-05: สร้างธนาคารใหม่

**เป้าหมาย**: สร้างธนาคารใหม่เพื่อใช้เมื่อสร้างบัญชีเงินออม

**ขั้นตอนหลัก**:
1. บนหน้าจอ "เพิ่มบัญชีเงินออม" หรือ "แก้ไขบัญชีเงินออม"
2. แตะปุ่ม "+" ข้างดรอปดาวน์ "ธนาคาร"
3. ใส่ชื่อธนาคาร, รหัสธนาคาร
4. เลือกสีไอคอน
5. ดูตัวอย่างไอคอน
6. แตะ "สร้าง"

**Wireframe - กล่องโต้ตอบสร้างธนาคาร**:

```text
┌─────────────────────────────────────────┐
│  เพิ่มธนาคารใหม่                        │
├─────────────────────────────────────────┤
│  ชื่อธนาคาร                             │
│  [ ธนาคาร ABC ]                         │
│                                         │
│  รหัสธนาคาร                             │
│  [ ABC ]                                │
│                                         │
│  สีไอคอน                                │
│  [ 🎨 ]  #FF5722                        │
│                                         │
│  ตัวอย่างไอคอน                          │
│  ┌─────────┐                            │
│  │   ABC   │  (พื้นหลัง: #FF5722)       │
│  └─────────┘                            │
│                                         │
│  [  ยกเลิก  ]    [  สร้าง  ]           │
└─────────────────────────────────────────┘
```

---

### SAVINGS-06: แก้ไขบัญชีเงินออม

**เป้าหมาย**: แก้ไขข้อมูลของบัญชีเงินออมที่ใช้งาน (ธนาคาร, จำนวนเงิน, ระยะเวลา, อัตราดอกเบี้ย, แผนครบกำหนด)

**ขั้นตอนหลัก**:
1. ไปที่รายละเอียดบัญชีเงินออมที่ใช้งาน
2. แตะปุ่ม "แก้ไข"
3. แก้ไขข้อมูลที่จำเป็น
4. ดูวันที่ครบกำหนดคำนวณใหม่อัตโนมัติ (ถ้าเปลี่ยนระยะเวลา/วันที่เริ่มต้น)
5. แตะ "บันทึกการเปลี่ยนแปลง"

**ผลลัพธ์**: ข้อมูลบัญชีถูกอัปเดต ดอกเบี้ยโดยประมาณถูกคำนวณใหม่ตามอัตราดอกเบี้ยใหม่ ถ้าจำนวนเงินเปลี่ยนแปลง ยอดเงินปัจจุบันจะถูกปรับตาม

## 6. ตรรกะและกฎ

### 6.1 การคำนวณดอกเบี้ย

- ดอกเบี้ยคำนวณตามสูตร: `จำนวนเงิน × อัตราดอกเบี้ย × (ระยะเวลา / 12)`
- ดอกเบี้ยคำนวณเมื่อครบกำหนดหรือเมื่อถอนก่อนกำหนด

### 6.2 สถานะ

- **ใช้งาน (ACTIVE)**: บัญชีเงินออมใช้งาน ยังไม่ถึงวันที่ครบกำหนดหรือยังไม่ถูกประมวลผล
- **เสร็จสมบูรณ์ (COMPLETED)**: บัญชีถูกถอนแล้ว
- **ต่ออายุแล้ว (ROLLED_OVER)**: บัญชีถูกต่ออายุ บัญชีใหม่ถูกสร้าง

### 6.3 การถอนและการต่ออายุ

- **การถอน**: เมื่อถอน เงินต้น + ดอกเบี้ยจะถูกเพิ่มเข้ายอดเงินปัจจุบัน สร้าง "รายได้พิเศษ" อัตโนมัติพร้อมหมวดหมู่ "ดอกเบี้ยเงินออม"
- **การถอนก่อนกำหนด**: สามารถถอนก่อนวันที่ครบกำหนดได้ ดอกเบี้ยที่ได้รับอาจต่ำกว่าดอกเบี้ยโดยประมาณ
- **ต่ออายุเงินต้น**: ดอกเบี้ยถูกเพิ่มเข้ายอดเงินปัจจุบัน เงินต้นถูกต่ออายุพร้อมระยะเวลาใหม่
- **ต่ออายุเงินต้น + ดอกเบี้ย**: ทั้งเงินต้นและดอกเบี้ยถูกต่ออายุ ยอดเงินปัจจุบันไม่เปลี่ยนแปลง
- **ประวัติการต่ออายุ**: การต่ออายุถูกบันทึกและแสดงในรายละเอียดบัญชี เชื่อมโยงผ่าน `rootSavingId`

### 6.4 การแจ้งเตือน

- แอปส่งการแจ้งเตือนเมื่อถึงวันที่ครบกำหนด
- เวลาแจ้งเตือนสามารถกำหนดได้สำหรับแต่ละบัญชี (`notificationTime1`, `notificationTime2`, ค่าเริ่มต้น 10:00 และ 19:00)

## 7. หมายเหตุสำคัญ

- **ต้องการโมดูลพรีเมียม**: ฟีเจอร์นี้สำหรับผู้ใช้พรีเมียมเท่านั้น
- **อัตราดอกเบี้ย**: ใส่อัตราดอกเบี้ยต่อปี (%/ปี) จาก 1 ถึง 100%
- **ระยะเวลา**: คำนวณเป็นเดือน จาก 1 ถึง 36 เดือน
- **วันที่ครบกำหนด**: คำนวณอัตโนมัติจากวันที่เริ่มต้น + ระยะเวลา
- **จำนวนเงินฝาก**: ต้อง ≤ ยอดเงินปัจจุบัน เมื่อสร้างบัญชีจะหักจากยอดเงินปัจจุบันอัตโนมัติ
- **วันที่เริ่มต้น**: สามารถเลือกเฉพาะตั้งแต่ต้นเดือนก่อนหน้าถึงปัจจุบัน
- **การแจ้งเตือน**: การแจ้งเตือนถูกส่งในวันที่ครบกำหนด 2 ครั้ง (ค่าเริ่มต้น 10:00 และ 19:00) สามารถกำหนดเองสำหรับแต่ละบัญชีได้
- **ป้าย "ใกล้ครบกำหนด"**: แสดงเมื่อ ≤ 7 วันจนถึงวันที่ครบกำหนด
- **ป้าย "ครบกำหนดแล้ว"**: แสดงเมื่อถึงวันที่ครบกำหนด
- **ลบบัญชี**: เมื่อลบบัญชีที่ใช้งาน จำนวนเงินต้นจะถูกเพิ่มกลับเข้ายอดเงินปัจจุบัน การลบบัญชีรากจะลบสายการต่ออายุทั้งหมด
- **การ์ดภาพรวม**: เปลี่ยนแปลงตามตัวกรอง แสดงข้อมูลรวมสำหรับบัญชีที่ใช้งานหรือเสร็จสมบูรณ์

